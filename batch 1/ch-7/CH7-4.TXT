SQL> 
SQL> REM 3 SUB QUERY CAN BE USED TO COMPARE NESTED SUMMARY FUNCTION IN 'HAVING' CLAUSE.
SQL> 
SQL> REM SELECT SYNTAX : SELECT ... FROM ... WHERE ... GROUP BY / HAVING ... ORDER BY ... OFFSET ... FETCH ...;
SQL> 
SQL> REM EXECUTION PRECEDENCE : FROM ... WHERE ... GROUP BY ... HAVING ... COLUMN ALIAS ATTACHMENT ... ORDER BY ... OFFSET ... FETCH ... SELECT ...;
SQL> 
SQL> SELECT AVG(SALARY) FROM EMPLOYEES;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       8775                                                                                                                                                                                             

SQL> SELECT AVG(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = 50;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       3500                                                                                                                                                                                             

SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
           20        9500                                                                                                                                                                               
          110       10150                                                                                                                                                                               
           50        3500                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           60        6400                                                                                                                                                                               
           10        4400                                                                                                                                                                               

8 rows selected.

SQL> SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MAX(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      19333.3333                                                                                                                                                                                        

SQL> SELECT DEPARTMENT_ID , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT DEPARTMENT_ID , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = MAX(AVG(SALARY));
HAVING AVG(SALARY) = MAX(AVG(SALARY))
                         *
ERROR at line 2:
ORA-00935: group function is nested too deeply 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
  2  HAVING AVG(SALARY) = (SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               

SQL> REM DISPLAY HIGHEST AVERAGE SALARY PAID TO DEPARTMENT
SQL> 
SQL> REM DISPLAY LOWEST AVERAGE SALARY PAID TO JOB_ID
SQL> 
SQL> SELECT JOB_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY JOB_ID;

JOB_ID     AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           6400                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            17000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP      8866.66667                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

12 rows selected.

SQL> SELECT JOB_ID , AVG(SALARY) FROM EMPLOYEES GROUP BY JOB_ID
  2  HAVING AVG(SALARY) = (SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     AVG(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
ST_CLERK          2925                                                                                                                                                                                  

SQL> REM DISPLAY HIGHEST TOTAL SALARY PAID TO MANAGER
SQL> 
SQL> REM DISPLAY HIGHEST TOTAL SALARY PAID FOR MANAGER
SQL> 
SQL> SELECT MANAGER_ID,SUM(SALARY) FROM EMPLOYEES GROUP BY MANAGER_ID
  2  HAVING SUM(SALARY) = (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY MANAGER_ID);

MANAGER_ID SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
       100       63300                                                                                                                                                                                  

SQL> REM DISPLAY HIGHEST COUNT OF EMPLOYEES FOR HIRE YEAR
SQL> 
SQL> SELECT TO_CHAR(HIRE_DATE,'YYYY') , MAX(COUNT(*))
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE,'YYYY')
  4  HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'YYYY'))
  5  
SQL> 
SQL> SELECT TO_CHAR(HIRE_DATE,'YYYY') , COUNT(*)
  2  FROM EMPLOYEES
  3  GROUP BY TO_CHAR(HIRE_DATE,'YYYY')
  4  HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'YYYY'));

TO_C   COUNT(*)                                                                                                                                                                                         
---- ----------                                                                                                                                                                                         
1999          3                                                                                                                                                                                         
1998          3                                                                                                                                                                                         

SQL> REM DISPLAY ALL EXCEPT THOSE DEPARTMENT FOR WHICH LOWEST TOTAL SALARY IS PAID.
SQL> 
SQL> SELECT DEPARTMENT_ID,SUM(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING SUM(SALARY)<>(SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID SUM(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90       58000                                                                                                                                                                               
           20       19000                                                                                                                                                                               
          110       20300                                                                                                                                                                               
           50       17500                                                                                                                                                                               
           80       30100                                                                                                                                                                               
           60       19200                                                                                                                                                                               

7 rows selected.

SQL> REM <> != ^=
SQL> 
SQL> SELECT DEPARTMENT_ID,SUM(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING NOT SUM(SALARY) = (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

DEPARTMENT_ID SUM(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90       58000                                                                                                                                                                               
           20       19000                                                                                                                                                                               
          110       20300                                                                                                                                                                               
           50       17500                                                                                                                                                                               
           80       30100                                                                                                                                                                               
           60       19200                                                                                                                                                                               

7 rows selected.

SQL> REM DISPLAY JOB_ID AND SUM OF SALARY FOR THE JOBS EXCEPT WHICH GETS EITHER LOWEST OR HIGHEST SUM OF SALARY
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) NOT IN ((SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID),
  5                             (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID));

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

10 rows selected.

SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) <> ALL ((SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID),
  5                             (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID));

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

10 rows selected.

SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING SUM(SALARY) <> (SELECT MIN(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID)
  5  AND    SUM(SALARY) <> (SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID);

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
AC_MGR           12000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
AD_PRES          24000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

10 rows selected.

SQL> REM 4 SUB QUERY CAN BE USED WHEN WE WANT TO USE RESULT OF SUB QUERY AS TABLE FOR MAIN QUERY.
SQL> 
SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY FROM EMPLOYEES ORDER BY 2,3 DESC;

FIRST_NAME DEPARTMENT_ID     SALARY                                                                                                                                                                     
---------- ------------- ----------                                                                                                                                                                     
Jennifer              10       4400                                                                                                                                                                     
Michael               20      13000                                                                                                                                                                     
Pat                   20       6000                                                                                                                                                                     
Kevin                 50       5800                                                                                                                                                                     
Trenna                50       3500                                                                                                                                                                     
Curtis                50       3100                                                                                                                                                                     
Randall               50       2600                                                                                                                                                                     
Peter                 50       2500                                                                                                                                                                     
Alexander             60       9000                                                                                                                                                                     
Bruce                 60       6000                                                                                                                                                                     
Diana                 60       4200                                                                                                                                                                     
Ellen                 80      11000                                                                                                                                                                     
Eleni                 80      10500                                                                                                                                                                     
Jonathon              80       8600                                                                                                                                                                     
Steven                90      24000                                                                                                                                                                     
Lex                   90      17000                                                                                                                                                                     
Neena                 90      17000                                                                                                                                                                     
Shelley              110      12000                                                                                                                                                                     
William              110       8300                                                                                                                                                                     
Kimerely                       7000                                                                                                                                                                     

20 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES ORDER BY 2,3 DESC;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES ORDER BY 2,3 DESC
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY) FROM EMPLOYEES GROUP BY FIRST_NAME , DEPARTMENT_ID , SALARY ;

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Curtis                50       3100        3100                                                                                                                                                         
Randall               50       2600        2600                                                                                                                                                         
Eleni                 80      10500       10500                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Lex                   90      17000       17000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Pat                   20       6000        6000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300        8300                                                                                                                                                         
Neena                 90      17000       17000                                                                                                                                                         
Peter                 50       2500        2500                                                                                                                                                         
Bruce                 60       6000        6000                                                                                                                                                         
Jonathon              80       8600        8600                                                                                                                                                         
Kimerely                       7000        7000                                                                                                                                                         
Diana                 60       4200        4200                                                                                                                                                         
Trenna                50       3500        3500                                                                                                                                                         

20 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID MAX(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
                     7000                                                                                                                                                                               
           90       24000                                                                                                                                                                               
           20       13000                                                                                                                                                                               
          110       12000                                                                                                                                                                               
           50        5800                                                                                                                                                                               
           80       11000                                                                                                                                                                               
           60        9000                                                                                                                                                                               
           10        4400                                                                                                                                                                               

8 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) MAXSALARY
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID;

DEPARTMENT_ID  MAXSALARY                                                                                                                                                                                
------------- ----------                                                                                                                                                                                
                    7000                                                                                                                                                                                
           90      24000                                                                                                                                                                                
           20      13000                                                                                                                                                                                
          110      12000                                                                                                                                                                                
           50       5800                                                                                                                                                                                
           80      11000                                                                                                                                                                                
           60       9000                                                                                                                                                                                
           10       4400                                                                                                                                                                                

8 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAXSALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) MAXSALARY FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MAXSALARY                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , maxsalary
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) MAXSALARY FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MAXSALARY                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MaxSalary
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MaxSalary
                                             *
ERROR at line 1:
ORA-00904: "MAXSALARY": invalid identifier 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MaxSalary"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) "MaxSalary" FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY  MaxSalary                                                                                                                                                          
---------- ------------- ---------- ----------                                                                                                                                                          
Steven                90      24000      24000                                                                                                                                                          
Neena                 90      17000      24000                                                                                                                                                          
Lex                   90      17000      24000                                                                                                                                                          
Alexander             60       9000       9000                                                                                                                                                          
Bruce                 60       6000       9000                                                                                                                                                          
Diana                 60       4200       9000                                                                                                                                                          
Kevin                 50       5800       5800                                                                                                                                                          
Trenna                50       3500       5800                                                                                                                                                          
Curtis                50       3100       5800                                                                                                                                                          
Randall               50       2600       5800                                                                                                                                                          
Peter                 50       2500       5800                                                                                                                                                          
Eleni                 80      10500      11000                                                                                                                                                          
Ellen                 80      11000      11000                                                                                                                                                          
Jonathon              80       8600      11000                                                                                                                                                          
Jennifer              10       4400       4400                                                                                                                                                          
Michael               20      13000      13000                                                                                                                                                          
Pat                   20       6000      13000                                                                                                                                                          
Shelley              110      12000      12000                                                                                                                                                          
William              110       8300      12000                                                                                                                                                          

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , MAX(SALARY)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Neena                 90      17000       24000                                                                                                                                                         
Lex                   90      17000       24000                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Bruce                 60       6000        9000                                                                                                                                                         
Diana                 60       4200        9000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Trenna                50       3500        5800                                                                                                                                                         
Curtis                50       3100        5800                                                                                                                                                         
Randall               50       2600        5800                                                                                                                                                         
Peter                 50       2500        5800                                                                                                                                                         
Eleni                 80      10500       11000                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Jonathon              80       8600       11000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Pat                   20       6000       13000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300       12000                                                                                                                                                         

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , T2.MAX(SALARY)
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID) T2;
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , T2.MAX(SALARY)
                                             *
ERROR at line 1:
ORA-00904: "T2"."MAX": invalid identifier 


SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(SALARY)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , max(salary) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);

FIRST_NAME DEPARTMENT_ID     SALARY MAX(SALARY)                                                                                                                                                         
---------- ------------- ---------- -----------                                                                                                                                                         
Steven                90      24000       24000                                                                                                                                                         
Neena                 90      17000       24000                                                                                                                                                         
Lex                   90      17000       24000                                                                                                                                                         
Alexander             60       9000        9000                                                                                                                                                         
Bruce                 60       6000        9000                                                                                                                                                         
Diana                 60       4200        9000                                                                                                                                                         
Kevin                 50       5800        5800                                                                                                                                                         
Trenna                50       3500        5800                                                                                                                                                         
Curtis                50       3100        5800                                                                                                                                                         
Randall               50       2600        5800                                                                                                                                                         
Peter                 50       2500        5800                                                                                                                                                         
Eleni                 80      10500       11000                                                                                                                                                         
Ellen                 80      11000       11000                                                                                                                                                         
Jonathon              80       8600       11000                                                                                                                                                         
Jennifer              10       4400        4400                                                                                                                                                         
Michael               20      13000       13000                                                                                                                                                         
Pat                   20       6000       13000                                                                                                                                                         
Shelley              110      12000       12000                                                                                                                                                         
William              110       8300       12000                                                                                                                                                         

19 rows selected.

SQL> SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(salary)"
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT DEPARTMENT_ID , MAX(salary) FROM EMPLOYEES GROUP BY DEPARTMENT_ID);
SELECT FIRST_NAME , DEPARTMENT_ID , SALARY , "MAX(salary)"
                                             *
ERROR at line 1:
ORA-00904: "MAX(salary)": invalid identifier 


SQL> SELECT SALARY * COMMISSION_PCT COMM_amount FROM EMPLOYEES;

COMM_AMOUNT                                                                                                                                                                                             
-----------                                                                                                                                                                                             
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
       2100                                                                                                                                                                                             
       3300                                                                                                                                                                                             
       2580                                                                                                                                                                                             
       1050                                                                                                                                                                                             
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        

20 rows selected.

SQL> REM LAST_NAME , JOB_ID , SALARY , LOWEST_SALARY_PAID_FOR_JOB_ID
SQL> 
SQL> SELECT LAST_NAME , JOB_ID , SALARY , 'MINSALARY' FROM EMPLOYEES NATURAL JOIN (SELECT JOB_ID, MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME  JOB_ID         SALARY 'MINSALAR                                                                                                                                                              
---------- ---------- ---------- ---------                                                                                                                                                              
King       AD_PRES         24000 MINSALARY                                                                                                                                                              
Kochhar    AD_VP           17000 MINSALARY                                                                                                                                                              
De Haan    AD_VP           17000 MINSALARY                                                                                                                                                              
Hunold     IT_PROG          9000 MINSALARY                                                                                                                                                              
Ernst      IT_PROG          6000 MINSALARY                                                                                                                                                              
Lorentz    IT_PROG          4200 MINSALARY                                                                                                                                                              
Mourgos    ST_MAN           5800 MINSALARY                                                                                                                                                              
Rajs       ST_CLERK         3500 MINSALARY                                                                                                                                                              
Davies     ST_CLERK         3100 MINSALARY                                                                                                                                                              
Matos      ST_CLERK         2600 MINSALARY                                                                                                                                                              
Vargas     ST_CLERK         2500 MINSALARY                                                                                                                                                              
Zlotkey    SA_MAN          10500 MINSALARY                                                                                                                                                              
Abel       SA_REP          11000 MINSALARY                                                                                                                                                              
Taylor     SA_REP           8600 MINSALARY                                                                                                                                                              
Grant      SA_REP           7000 MINSALARY                                                                                                                                                              
Whalen     AD_ASST          4400 MINSALARY                                                                                                                                                              
Hartstein  MK_MAN          13000 MINSALARY                                                                                                                                                              
Fay        MK_REP           6000 MINSALARY                                                                                                                                                              
Higgins    AC_MGR          12000 MINSALARY                                                                                                                                                              
Gietz      AC_ACCOUNT       8300 MINSALARY                                                                                                                                                              

20 rows selected.

SQL> SELECT LAST_NAME , JOB_ID , SALARY , "MIN(SALARY)" FROM EMPLOYEES NATURAL JOIN (SELECT JOB_ID, MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);

LAST_NAME  JOB_ID         SALARY MIN(SALARY)                                                                                                                                                            
---------- ---------- ---------- -----------                                                                                                                                                            
King       AD_PRES         24000       24000                                                                                                                                                            
Kochhar    AD_VP           17000       17000                                                                                                                                                            
De Haan    AD_VP           17000       17000                                                                                                                                                            
Hunold     IT_PROG          9000        4200                                                                                                                                                            
Ernst      IT_PROG          6000        4200                                                                                                                                                            
Lorentz    IT_PROG          4200        4200                                                                                                                                                            
Mourgos    ST_MAN           5800        5800                                                                                                                                                            
Rajs       ST_CLERK         3500        2500                                                                                                                                                            
Davies     ST_CLERK         3100        2500                                                                                                                                                            
Matos      ST_CLERK         2600        2500                                                                                                                                                            
Vargas     ST_CLERK         2500        2500                                                                                                                                                            
Zlotkey    SA_MAN          10500       10500                                                                                                                                                            
Abel       SA_REP          11000        7000                                                                                                                                                            
Taylor     SA_REP           8600        7000                                                                                                                                                            
Grant      SA_REP           7000        7000                                                                                                                                                            
Whalen     AD_ASST          4400        4400                                                                                                                                                            
Hartstein  MK_MAN          13000       13000                                                                                                                                                            
Fay        MK_REP           6000        6000                                                                                                                                                            
Higgins    AC_MGR          12000       12000                                                                                                                                                            
Gietz      AC_ACCOUNT       8300        8300                                                                                                                                                            

20 rows selected.

SQL> REM EMPLOYEE_ID , MANAGER_ID , SALARY , AVERAGE_SALARY_PAID_FOR_MANAGER_ID
SQL> 
SQL> SELECT EMPLOYEE_ID, MANAGER_ID, SALARY, AVG(SALARY) AVERAGE_SALARY_PAID_FOR_MANAGER_ID FROM EMPLOYEES NATURAL JOIN (SELECT MANAGER_ID, TRUNC(AVG(SALARY),2) FROM EMPLOYEES GROUP BY MANAGER_ID);
SELECT EMPLOYEE_ID, MANAGER_ID, SALARY, AVG(SALARY) AVERAGE_SALARY_PAID_FOR_MANAGER_ID FROM EMPLOYEES NATURAL JOIN (SELECT MANAGER_ID, TRUNC(AVG(SALARY),2) FROM EMPLOYEES GROUP BY MANAGER_ID)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT EMPLOYEE_ID, MANAGER_ID, SALARY, AVGSAL FROM EMPLOYEES NATURAL JOIN (SELECT MANAGER_ID, TO_CHAR(AVG(SALARY),'99999.99') AVGSAL FROM EMPLOYEES GROUP BY MANAGER_ID);

EMPLOYEE_ID MANAGER_ID     SALARY AVGSAL                                                                                                                                                                
----------- ---------- ---------- ---------                                                                                                                                                             
        101        100      17000  12660.00                                                                                                                                                             
        102        100      17000  12660.00                                                                                                                                                             
        103        102       9000   9000.00                                                                                                                                                             
        104        103       6000   5100.00                                                                                                                                                             
        107        103       4200   5100.00                                                                                                                                                             
        124        100       5800  12660.00                                                                                                                                                             
        141        124       3500   2925.00                                                                                                                                                             
        142        124       3100   2925.00                                                                                                                                                             
        143        124       2600   2925.00                                                                                                                                                             
        144        124       2500   2925.00                                                                                                                                                             
        149        100      10500  12660.00                                                                                                                                                             
        174        149      11000   8866.67                                                                                                                                                             
        176        149       8600   8866.67                                                                                                                                                             
        178        149       7000   8866.67                                                                                                                                                             
        200        101       4400   8200.00                                                                                                                                                             
        201        100      13000  12660.00                                                                                                                                                             
        202        201       6000   6000.00                                                                                                                                                             
        205        101      12000   8200.00                                                                                                                                                             
        206        205       8300   8300.00                                                                                                                                                             

19 rows selected.

SQL> REM FIRST_NAME , JOB_ID , SALARY , MINSALARY , MAXSALARY
SQL> 
SQL> SELECT FIRST_NAME , JOB_ID , SALARY , MINSALARY , MAXSALARY
  2  FROM EMPLOYEES
  3  NATURAL JOIN (SELECT JOB_ID , MIN(SALARY) MINSALARY , MAX(SALARY) MAXSALARY FROM EMPLOYEES GROUP BY JOB_ID);

FIRST_NAME JOB_ID         SALARY  MINSALARY  MAXSALARY                                                                                                                                                  
---------- ---------- ---------- ---------- ----------                                                                                                                                                  
Steven     AD_PRES         24000      24000      24000                                                                                                                                                  
Neena      AD_VP           17000      17000      17000                                                                                                                                                  
Lex        AD_VP           17000      17000      17000                                                                                                                                                  
Alexander  IT_PROG          9000       4200       9000                                                                                                                                                  
Bruce      IT_PROG          6000       4200       9000                                                                                                                                                  
Diana      IT_PROG          4200       4200       9000                                                                                                                                                  
Kevin      ST_MAN           5800       5800       5800                                                                                                                                                  
Trenna     ST_CLERK         3500       2500       3500                                                                                                                                                  
Curtis     ST_CLERK         3100       2500       3500                                                                                                                                                  
Randall    ST_CLERK         2600       2500       3500                                                                                                                                                  
Peter      ST_CLERK         2500       2500       3500                                                                                                                                                  
Eleni      SA_MAN          10500      10500      10500                                                                                                                                                  
Ellen      SA_REP          11000       7000      11000                                                                                                                                                  
Jonathon   SA_REP           8600       7000      11000                                                                                                                                                  
Kimerely   SA_REP           7000       7000      11000                                                                                                                                                  
Jennifer   AD_ASST          4400       4400       4400                                                                                                                                                  
Michael    MK_MAN          13000      13000      13000                                                                                                                                                  
Pat        MK_REP           6000       6000       6000                                                                                                                                                  
Shelley    AC_MGR          12000      12000      12000                                                                                                                                                  
William    AC_ACCOUNT       8300       8300       8300                                                                                                                                                  

20 rows selected.

SQL> REM FIRST_NAME , MANAGER_ID , SALARY , HIGHEST_SALARY , DIFFERENCE
SQL> 
SQL> SELECT FIRST_NAME , MANAGER_ID , SALARY , HIGEST_SALARY ,(HIGEST_SALARY-SALARY) DIFFRENCE
  2  FROM EMPLOYEES NATURAL JOIN(SELECT MANAGER_ID , MAX(SALARY) HIGEST_SALARY FROM EMPLOYEES GROUP BY MANAGER_ID);

FIRST_NAME MANAGER_ID     SALARY HIGEST_SALARY  DIFFRENCE                                                                                                                                               
---------- ---------- ---------- ------------- ----------                                                                                                                                               
Neena             100      17000         17000          0                                                                                                                                               
Lex               100      17000         17000          0                                                                                                                                               
Alexander         102       9000          9000          0                                                                                                                                               
Bruce             103       6000          6000          0                                                                                                                                               
Diana             103       4200          6000       1800                                                                                                                                               
Kevin             100       5800         17000      11200                                                                                                                                               
Trenna            124       3500          3500          0                                                                                                                                               
Curtis            124       3100          3500        400                                                                                                                                               
Randall           124       2600          3500        900                                                                                                                                               
Peter             124       2500          3500       1000                                                                                                                                               
Eleni             100      10500         17000       6500                                                                                                                                               
Ellen             149      11000         11000          0                                                                                                                                               
Jonathon          149       8600         11000       2400                                                                                                                                               
Kimerely          149       7000         11000       4000                                                                                                                                               
Jennifer          101       4400         12000       7600                                                                                                                                               
Michael           100      13000         17000       4000                                                                                                                                               
Pat               201       6000          6000          0                                                                                                                                               
Shelley           101      12000         12000          0                                                                                                                                               
William           205       8300          8300          0                                                                                                                                               

19 rows selected.

SQL> SPOOL OFF
