SQL> 
SQL> CL SCR

SQL> REM REMOVE ALL e FROM FIRST_NAME
SQL> 
SQL> 
SQL> SELECT FIRST_NAME , REPLACE(LOWER(FIRST_NAME),'e') FROM EMPLOYEES;

FIRST_NAME REPLACE(LO                                                           
---------- ----------                                                           
Steven     stvn                                                                 
Neena      nna                                                                  
Lex        lx                                                                   
Alexander  alxandr                                                              
Bruce      bruc                                                                 
Diana      diana                                                                
Kevin      kvin                                                                 
Trenna     trnna                                                                
Curtis     curtis                                                               
Randall    randall                                                              
Peter      ptr                                                                  

FIRST_NAME REPLACE(LO                                                           
---------- ----------                                                           
Eleni      lni                                                                  
Ellen      lln                                                                  
Jonathon   jonathon                                                             
Kimerely   kimrly                                                               
Jennifer   jnnifr                                                               
Michael    michal                                                               
Pat        pat                                                                  
Shelley    shlly                                                                
William    william                                                              

20 rows selected.

SQL> SET LINES 200 PAGES 24
SQL> 
SQL> R
  1* SELECT FIRST_NAME , REPLACE(LOWER(FIRST_NAME),'e') FROM EMPLOYEES

FIRST_NAME REPLACE(LO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
Steven     stvn                                                                                                                                                                                         
Neena      nna                                                                                                                                                                                          
Lex        lx                                                                                                                                                                                           
Alexander  alxandr                                                                                                                                                                                      
Bruce      bruc                                                                                                                                                                                         
Diana      diana                                                                                                                                                                                        
Kevin      kvin                                                                                                                                                                                         
Trenna     trnna                                                                                                                                                                                        
Curtis     curtis                                                                                                                                                                                       
Randall    randall                                                                                                                                                                                      
Peter      ptr                                                                                                                                                                                          
Eleni      lni                                                                                                                                                                                          
Ellen      lln                                                                                                                                                                                          
Jonathon   jonathon                                                                                                                                                                                     
Kimerely   kimrly                                                                                                                                                                                       
Jennifer   jnnifr                                                                                                                                                                                       
Michael    michal                                                                                                                                                                                       
Pat        pat                                                                                                                                                                                          
Shelley    shlly                                                                                                                                                                                        
William    william                                                                                                                                                                                      

20 rows selected.

SQL> REM 13 DISPLAY ALL FEBRUARY DATES WITH feb AS MONTH NAME, ALL REMAINING DATES AS IT IS.
SQL> 
SQL> SELECT HIRE_DATE , REPLACE(HIRE_DATE,'FEB','feb') FROM EMPLOYEES;

HIRE_DATE REPLACE(HIRE_DATE,'FEB','FEB')                                                                                                                                                                
--------- ------------------------------------------------------                                                                                                                                        
17-JUL-87 17-JUL-87                                                                                                                                                                                     
21-SEP-89 21-SEP-89                                                                                                                                                                                     
13-JAN-93 13-JAN-93                                                                                                                                                                                     
03-JAN-90 03-JAN-90                                                                                                                                                                                     
21-MAY-91 21-MAY-91                                                                                                                                                                                     
07-FEB-99 07-feb-99                                                                                                                                                                                     
16-NOV-99 16-NOV-99                                                                                                                                                                                     
17-OCT-95 17-OCT-95                                                                                                                                                                                     
29-JAN-97 29-JAN-97                                                                                                                                                                                     
15-MAR-98 15-MAR-98                                                                                                                                                                                     
09-JUL-98 09-JUL-98                                                                                                                                                                                     
29-JAN-00 29-JAN-00                                                                                                                                                                                     
11-MAY-96 11-MAY-96                                                                                                                                                                                     
24-MAR-98 24-MAR-98                                                                                                                                                                                     
24-MAY-99 24-MAY-99                                                                                                                                                                                     
17-SEP-87 17-SEP-87                                                                                                                                                                                     
17-FEB-96 17-feb-96                                                                                                                                                                                     
17-AUG-97 17-AUG-97                                                                                                                                                                                     
07-JUN-94 07-JUN-94                                                                                                                                                                                     
07-JUN-94 07-JUN-94                                                                                                                                                                                     

20 rows selected.

SQL> 11 DISPLAY HIRE_DATE WITH WHOLE SPELLING OF SEPTEMBER, REMAINING DATES AS IT IS
SQL> 
SQL> SELECT HIRE_DATE , REPLACE(HIRE_DATE,'SEP','SEPTEMBER') FROM EMPLOYEES;

HIRE_DATE REPLACE(HIRE_DATE,'SEP','SEPTEMBER')                                                                                                                                                          
--------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------                            
17-JUL-87 17-JUL-87                                                                                                                                                                                     
21-SEP-89 21-SEPTEMBER-89                                                                                                                                                                               
13-JAN-93 13-JAN-93                                                                                                                                                                                     
03-JAN-90 03-JAN-90                                                                                                                                                                                     
21-MAY-91 21-MAY-91                                                                                                                                                                                     
07-FEB-99 07-FEB-99                                                                                                                                                                                     
16-NOV-99 16-NOV-99                                                                                                                                                                                     
17-OCT-95 17-OCT-95                                                                                                                                                                                     
29-JAN-97 29-JAN-97                                                                                                                                                                                     
15-MAR-98 15-MAR-98                                                                                                                                                                                     
09-JUL-98 09-JUL-98                                                                                                                                                                                     
29-JAN-00 29-JAN-00                                                                                                                                                                                     
11-MAY-96 11-MAY-96                                                                                                                                                                                     
24-MAR-98 24-MAR-98                                                                                                                                                                                     
24-MAY-99 24-MAY-99                                                                                                                                                                                     
17-SEP-87 17-SEPTEMBER-87                                                                                                                                                                               
17-FEB-96 17-FEB-96                                                                                                                                                                                     
17-AUG-97 17-AUG-97                                                                                                                                                                                     
07-JUN-94 07-JUN-94                                                                                                                                                                                     
07-JUN-94 07-JUN-94                                                                                                                                                                                     

20 rows selected.

SQL> REM 21 FIND POSITION OF SECOND 'a' IN LAST_NAME
SQL> 
SQL> 
SQL> SELECT LAST_NAME , INSTR(LOWER(LAST_NAME),'a') FROM EMPLOYEES;

LAST_NAME  INSTR(LOWER(LAST_NAME),'A')                                                                                                                                                                  
---------- ---------------------------                                                                                                                                                                  
King                                 0                                                                                                                                                                  
Kochhar                              6                                                                                                                                                                  
De Haan                              5                                                                                                                                                                  
Hunold                               0                                                                                                                                                                  
Ernst                                0                                                                                                                                                                  
Lorentz                              0                                                                                                                                                                  
Mourgos                              0                                                                                                                                                                  
Rajs                                 2                                                                                                                                                                  
Davies                               2                                                                                                                                                                  
Matos                                2                                                                                                                                                                  
Vargas                               2                                                                                                                                                                  
Zlotkey                              0                                                                                                                                                                  
Abel                                 1                                                                                                                                                                  
Taylor                               2                                                                                                                                                                  
Grant                                3                                                                                                                                                                  
Whalen                               3                                                                                                                                                                  
Hartstein                            2                                                                                                                                                                  
Fay                                  2                                                                                                                                                                  
Higgins                              0                                                                                                                                                                  
Gietz                                0                                                                                                                                                                  

20 rows selected.

SQL> SELECT LAST_NAME , INSTR(LOWER(LAST_NAME),'a',1,2) FROM EMPLOYEES;

LAST_NAME  INSTR(LOWER(LAST_NAME),'A',1,2)                                                                                                                                                              
---------- -------------------------------                                                                                                                                                              
King                                     0                                                                                                                                                              
Kochhar                                  0                                                                                                                                                              
De Haan                                  6                                                                                                                                                              
Hunold                                   0                                                                                                                                                              
Ernst                                    0                                                                                                                                                              
Lorentz                                  0                                                                                                                                                              
Mourgos                                  0                                                                                                                                                              
Rajs                                     0                                                                                                                                                              
Davies                                   0                                                                                                                                                              
Matos                                    0                                                                                                                                                              
Vargas                                   5                                                                                                                                                              
Zlotkey                                  0                                                                                                                                                              
Abel                                     0                                                                                                                                                              
Taylor                                   0                                                                                                                                                              
Grant                                    0                                                                                                                                                              
Whalen                                   0                                                                                                                                                              
Hartstein                                0                                                                                                                                                              
Fay                                      0                                                                                                                                                              
Higgins                                  0                                                                                                                                                              
Gietz                                    0                                                                                                                                                              

20 rows selected.

SQL> REM FIND POSITION OF 'o' FROM LAST_NAME FROM RIGHT
SQL> 
SQL> SELECT LAST_NAME , INSTR(LOWER(LAST_NAME),'o',-1) FROM EMPLOYEES;

LAST_NAME  INSTR(LOWER(LAST_NAME),'O',-1)                                                                                                                                                               
---------- ------------------------------                                                                                                                                                               
King                                    0                                                                                                                                                               
Kochhar                                 2                                                                                                                                                               
De Haan                                 0                                                                                                                                                               
Hunold                                  4                                                                                                                                                               
Ernst                                   0                                                                                                                                                               
Lorentz                                 2                                                                                                                                                               
Mourgos                                 6                                                                                                                                                               
Rajs                                    0                                                                                                                                                               
Davies                                  0                                                                                                                                                               
Matos                                   4                                                                                                                                                               
Vargas                                  0                                                                                                                                                               
Zlotkey                                 3                                                                                                                                                               
Abel                                    0                                                                                                                                                               
Taylor                                  5                                                                                                                                                               
Grant                                   0                                                                                                                                                               
Whalen                                  0                                                                                                                                                               
Hartstein                               0                                                                                                                                                               
Fay                                     0                                                                                                                                                               
Higgins                                 0                                                                                                                                                               
Gietz                                   0                                                                                                                                                               

20 rows selected.

SQL> REM SELECT SYNTCTICAL PRECEDENCE : SELECT ... FROM ... WHERE ... GROUP BY / HAVING ... ORDER BY ... OFFSET ... FETCH ...;
SQL> 
SQL> REM SELECT EXECUTION PRECEDENCE :  FROM ... WHERE ... GROUP BY ... HAVING ... COLUMN ALIAS ... ORDER BY ... OFFSET ... FETCH ... SELECT ...;
SQL> 
SQL> REM FROM : IT WILL READ ALL ROWS FROM TABLE AND PUT IT INTO MEMORY/RAM
SQL> 
SQL> REM WHERE : TO REMOVE ORIGINAL ROWS WHICH DOESN'T SATISFY 'WHERE' CONDITION.
SQL> 
SQL> REM GROUP BY : 1 WILL FIND DISTINCT VALUES OF GROUP BY COLUMN(S) 2 WILL SEPARATE ROWS IN GROUPS 3 WILL GENERATE SUMMARY ROW EACH GROUP
SQL> 
SQL> REM HAVING : TO REMOVE SUMMARY ROWS WHICH DOESN'T SATISFY 'HAVING' CONDITION.
SQL> 
SQL> REM COLUMN ALIAS : TO ATTACH NEW HEADING TO THE COLUMN WHICH IS REFERRED/SUPPORTED ONLY BY 'ORDER BY' CLAUSE.
SQL> 
SQL> REM ORDER BY : TO SORT ROWS ON SINGLE/MULTIPLE COLUMNS IN ASC/DESC ORDER KEEPING NULL VALUES AT TOP/BOTTOM
SQL> 
SQL> REM OFFSET : TO FIX STARTING ROW OF RESULT SET.
SQL> 
SQL> REM FETCH : TO FIX COUNT/NUMBER OF ROWS TO DISPLAY IN RESULT SET.
SQL> 
SQL> REM SELECT : TO DISPLAY/RETURN ROWS ON SCREEN/TO MAIN STATEMENT
SQL> 
SQL> 
SQL> REM WHERE WORKS ON TABLE'S ORIGINAL ROWS
SQL> 
SQL> REM HAVING WORKS ON SUMMARY ROWS
SQL> 
SQL> 
SQL> 
SQL> REM WHERE : SUPPORTS ONLY NON-SUMMARY ITEMS
SQL> 
SQL> REM HAVING : SUPPORTS ALL SUMMARY ITEMS + THOSE NON-SUMMARY ITEMS WHICH ARE PART OF 'GROUP BY' CLAUSE.
SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM DEPARTMENT_ID WISE AVERAGE SALARY
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  ORDER BY 1;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           10        4400                                                                                                                                                                               
           20        9500                                                                                                                                                                               
           50        3500                                                                                                                                                                               
           60        6400                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
          110       10150                                                                                                                                                                               
                     7000                                                                                                                                                                               

8 rows selected.

SQL> REM DISPLAY DEPARTMENT_ID AND AVERAGE SALARY FOR THE DEPARTMENTS TO WHICH 10000 OR MORE AVERAGE SALARY IS PAID.
SQL> 
SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  WHERE AVG(SALARY) > 10000
  4  GROUP BY DEPARTMENT_ID
  5  ORDER BY 1;
WHERE AVG(SALARY) > 10000
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  HAVING AVG(SALARY) > 10000
  4  GROUP BY DEPARTMENT_ID
  5  ORDER BY 1;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
          110       10150                                                                                                                                                                               

SQL> SELECT DEPARTMENT_ID , AVG(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY DEPARTMENT_ID
  4  HAVING AVG(SALARY) > 10000
  5  ORDER BY 1;

DEPARTMENT_ID AVG(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           80  10033.3333                                                                                                                                                                               
           90  19333.3333                                                                                                                                                                               
          110       10150                                                                                                                                                                               

SQL> REM DISPLAY JOB_ID WISE HIGHEST SALARY FOR THE JOB TO WHICH 9000 OR LESS HIGHEST SALARY IS PAID
SQL> 
SQL> SELECT JOB_ID , MAX(SALARY)
  2  FROM EMPLOYEES
  3  GROUP BY JOB_ID
  4  HAVING MAX(SALARY) <= 9000
  5  ORDER BY 2 DESC;

JOB_ID     MAX(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG           9000                                                                                                                                                                                  
AC_ACCOUNT        8300                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
ST_CLERK          3500                                                                                                                                                                                  

6 rows selected.

SQL> REM DISPLAY MANAGER_ID WISE LOWEST AND HIGHEST SALARY FOR THE MANAGERS TO WHICH AVERAGE SALARY IS PAID IN THE RANGE OF 6000-10000
SQL> 
SQL> SELECT MANAGER_ID , MIN(SALARY) , MAX(SALARY) FROM EMPLOYEES GROUP BY MANAGER _ID HAVING AVG(SALARY) BETWEEN 6000 AND 10000;
SELECT MANAGER_ID , MIN(SALARY) , MAX(SALARY) FROM EMPLOYEES GROUP BY MANAGER _ID HAVING AVG(SALARY) BETWEEN 6000 AND 10000
                                                                              *
ERROR at line 1:
ORA-00911: invalid character 


SQL> SELECT MANAGER_ID , MIN(SALARY) , MAX(SALARY) FROM EMPLOYEES GROUP BY MANAGER_ID HAVING AVG(SALARY) BETWEEN 6000 AND 10000;

MANAGER_ID MIN(SALARY) MAX(SALARY)                                                                                                                                                                      
---------- ----------- -----------                                                                                                                                                                      
       149        7000       11000                                                                                                                                                                      
       205        8300        8300                                                                                                                                                                      
       102        9000        9000                                                                                                                                                                      
       201        6000        6000                                                                                                                                                                      
       101        4400       12000                                                                                                                                                                      

SQL> REM DISPLAY JOB_ID AND COUNT OF EMPLOYEES. EXCLUDE THOSE WHO WERE HIRED AFTER YEAR 98.
SQL> REM ... DISPLAY ONLY THOSE JOBS FOR WHICH 2 OR MORE EMPLOYEES WERE HIRED.
SQL> 
SQL> 
SQL> SELECT JOB_ID , COUNT(*)
  2  FROM EMPLOYEES
  3  WHERE HIRE_DATE <= '31-DEC-98'
  4  GROUP BY JOB_ID
  5  HAVING COUNT(*) >= 2
  6  ORDER BY 1;

JOB_ID       COUNT(*)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
AD_VP               2                                                                                                                                                                                   
IT_PROG             2                                                                                                                                                                                   
SA_REP              2                                                                                                                                                                                   
ST_CLERK            4                                                                                                                                                                                   

SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME LAST_NAME  EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                               
----------- ---------- ---------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                               
        100 Steven     King       SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                               
        101 Neena      Kochhar    NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                               
        102 Lex        De Haan    LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                               
        103 Alexander  Hunold     AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                               
        104 Bruce      Ernst      BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                               
        107 Diana      Lorentz    DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                               
        124 Kevin      Mourgos    KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                               
        141 Trenna     Rajs       TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                               
        142 Curtis     Davies     CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                               
        143 Randall    Matos      RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                               
        144 Peter      Vargas     PVARGAS    650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                               
        149 Eleni      Zlotkey    EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                               
        174 Ellen      Abel       EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                               
        176 Jonathon   Taylor     JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                               
        178 Kimerely   Grant      KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                             
        200 Jennifer   Whalen     JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                               
        201 Michael    Hartstein  MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                               
        202 Pat        Fay        PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                               
        205 Shelley    Higgins    SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                               
        206 William    Gietz      WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                               

20 rows selected.

SQL> REM DISPLAY HIRE YEAR WISE , HIGHEST SALARY. EXCLUDE THOSE WHO REPORTS TO 124 AND 149.
SQL> 
SQL> REM ... DISPLAY ONLY THOSE HIRE YEAR ROWS IN WHICH LOWEST SALARY IS PAID UPTO 8000.
SQL> 
SQL> SELECT  MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID ^=ALL(124,149) GROUP BY TO_CHAR(HIRE_DATE,'YYYY') HAVING SALARY <=8000;
SELECT  MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID ^=ALL(124,149) GROUP BY TO_CHAR(HIRE_DATE,'YYYY') HAVING SALARY <=8000
                                                                                                             *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT  TO_CHAR(HIRE_DATE,'YYYY') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID ^=ALL(124,149) GROUP BY TO_CHAR(HIRE_DATE,'YYYY') HAVING MIN(SALARY) <=8000;

TO_C MAX(SALARY)                                                                                                                                                                                        
---- -----------                                                                                                                                                                                        
1987        4400                                                                                                                                                                                        
1997        6000                                                                                                                                                                                        
1991        6000                                                                                                                                                                                        
1999        5800                                                                                                                                                                                        

SQL> SELECT HIRE_DATE , TO_CHAR(HIRE_DATE,'RRRR') FROM EMPLOYEES;

HIRE_DATE TO_C                                                                                                                                                                                          
--------- ----                                                                                                                                                                                          
17-JUL-87 1987                                                                                                                                                                                          
21-SEP-89 1989                                                                                                                                                                                          
13-JAN-93 1993                                                                                                                                                                                          
03-JAN-90 1990                                                                                                                                                                                          
21-MAY-91 1991                                                                                                                                                                                          
07-FEB-99 1999                                                                                                                                                                                          
16-NOV-99 1999                                                                                                                                                                                          
17-OCT-95 1995                                                                                                                                                                                          
29-JAN-97 1997                                                                                                                                                                                          
15-MAR-98 1998                                                                                                                                                                                          
09-JUL-98 1998                                                                                                                                                                                          
29-JAN-00 2000                                                                                                                                                                                          
11-MAY-96 1996                                                                                                                                                                                          
24-MAR-98 1998                                                                                                                                                                                          
24-MAY-99 1999                                                                                                                                                                                          
17-SEP-87 1987                                                                                                                                                                                          
17-FEB-96 1996                                                                                                                                                                                          
17-AUG-97 1997                                                                                                                                                                                          
07-JUN-94 1994                                                                                                                                                                                          
07-JUN-94 1994                                                                                                                                                                                          

20 rows selected.

SQL> SELECT HIRE_DATE , TO_CHAR(HIRE_DATE,'Q') FROM EMPLOYEES;

HIRE_DATE T                                                                                                                                                                                             
--------- -                                                                                                                                                                                             
17-JUL-87 3                                                                                                                                                                                             
21-SEP-89 3                                                                                                                                                                                             
13-JAN-93 1                                                                                                                                                                                             
03-JAN-90 1                                                                                                                                                                                             
21-MAY-91 2                                                                                                                                                                                             
07-FEB-99 1                                                                                                                                                                                             
16-NOV-99 4                                                                                                                                                                                             
17-OCT-95 4                                                                                                                                                                                             
29-JAN-97 1                                                                                                                                                                                             
15-MAR-98 1                                                                                                                                                                                             
09-JUL-98 3                                                                                                                                                                                             
29-JAN-00 1                                                                                                                                                                                             
11-MAY-96 2                                                                                                                                                                                             
24-MAR-98 1                                                                                                                                                                                             
24-MAY-99 2                                                                                                                                                                                             
17-SEP-87 3                                                                                                                                                                                             
17-FEB-96 1                                                                                                                                                                                             
17-AUG-97 3                                                                                                                                                                                             
07-JUN-94 2                                                                                                                                                                                             
07-JUN-94 2                                                                                                                                                                                             

20 rows selected.

SQL> SELECT HIRE_DATE , TO_CHAR(HIRE_DATE,'MON') FROM EMPLOYEES;

HIRE_DATE TO_CHAR(HIRE                                                                                                                                                                                  
--------- ------------                                                                                                                                                                                  
17-JUL-87 JUL                                                                                                                                                                                           
21-SEP-89 SEP                                                                                                                                                                                           
13-JAN-93 JAN                                                                                                                                                                                           
03-JAN-90 JAN                                                                                                                                                                                           
21-MAY-91 MAY                                                                                                                                                                                           
07-FEB-99 FEB                                                                                                                                                                                           
16-NOV-99 NOV                                                                                                                                                                                           
17-OCT-95 OCT                                                                                                                                                                                           
29-JAN-97 JAN                                                                                                                                                                                           
15-MAR-98 MAR                                                                                                                                                                                           
09-JUL-98 JUL                                                                                                                                                                                           
29-JAN-00 JAN                                                                                                                                                                                           
11-MAY-96 MAY                                                                                                                                                                                           
24-MAR-98 MAR                                                                                                                                                                                           
24-MAY-99 MAY                                                                                                                                                                                           
17-SEP-87 SEP                                                                                                                                                                                           
17-FEB-96 FEB                                                                                                                                                                                           
17-AUG-97 AUG                                                                                                                                                                                           
07-JUN-94 JUN                                                                                                                                                                                           
07-JUN-94 JUN                                                                                                                                                                                           

20 rows selected.

SQL> SELECT HIRE_DATE , TO_CHAR(HIRE_DATE,'YYYY Q') FROM EMPLOYEES;

HIRE_DATE TO_CHA                                                                                                                                                                                        
--------- ------                                                                                                                                                                                        
17-JUL-87 1987 3                                                                                                                                                                                        
21-SEP-89 1989 3                                                                                                                                                                                        
13-JAN-93 1993 1                                                                                                                                                                                        
03-JAN-90 1990 1                                                                                                                                                                                        
21-MAY-91 1991 2                                                                                                                                                                                        
07-FEB-99 1999 1                                                                                                                                                                                        
16-NOV-99 1999 4                                                                                                                                                                                        
17-OCT-95 1995 4                                                                                                                                                                                        
29-JAN-97 1997 1                                                                                                                                                                                        
15-MAR-98 1998 1                                                                                                                                                                                        
09-JUL-98 1998 3                                                                                                                                                                                        
29-JAN-00 2000 1                                                                                                                                                                                        
11-MAY-96 1996 2                                                                                                                                                                                        
24-MAR-98 1998 1                                                                                                                                                                                        
24-MAY-99 1999 2                                                                                                                                                                                        
17-SEP-87 1987 3                                                                                                                                                                                        
17-FEB-96 1996 1                                                                                                                                                                                        
17-AUG-97 1997 3                                                                                                                                                                                        
07-JUN-94 1994 2                                                                                                                                                                                        
07-JUN-94 1994 2                                                                                                                                                                                        

20 rows selected.

SQL> SELECT HIRE_DATE , MAX(SALARY) FROM EMPLOYEES WHERE HAVING MIN(SALARY) 8000 GROUP BY MANAGER_ID NOT LIKE '124 AND 149';
SELECT HIRE_DATE , MAX(SALARY) FROM EMPLOYEES WHERE HAVING MIN(SALARY) 8000 GROUP BY MANAGER_ID NOT LIKE '124 AND 149'
                                                    *
ERROR at line 1:
ORA-00936: missing expression 


SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID NOT IN (124,149) HAVING MIN(SALARY) 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR');
SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID NOT IN (124,149) HAVING MIN(SALARY) 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR')
                                                                                                                   *
ERROR at line 1:
ORA-00920: invalid relational operator 


SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID NOT IN (124,149) HAVING MIN(SALARY) <= 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR');

TO_C MAX(SALARY)                                                                                                                                                                                        
---- -----------                                                                                                                                                                                        
1987        4400                                                                                                                                                                                        
1997        6000                                                                                                                                                                                        
1991        6000                                                                                                                                                                                        
1999        5800                                                                                                                                                                                        

SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID <> ALL (124,149) HAVING MIN(SALARY) <= 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR');

TO_C MAX(SALARY)                                                                                                                                                                                        
---- -----------                                                                                                                                                                                        
1987        4400                                                                                                                                                                                        
1997        6000                                                                                                                                                                                        
1991        6000                                                                                                                                                                                        
1999        5800                                                                                                                                                                                        

SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID != ALL (124,149) HAVING MIN(SALARY) <= 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR');

TO_C MAX(SALARY)                                                                                                                                                                                        
---- -----------                                                                                                                                                                                        
1987        4400                                                                                                                                                                                        
1997        6000                                                                                                                                                                                        
1991        6000                                                                                                                                                                                        
1999        5800                                                                                                                                                                                        

SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR') , MAX(SALARY) FROM EMPLOYEES WHERE MANAGER_ID ^= ALL (124,149) HAVING MIN(SALARY) <= 8000 GROUP BY TO_CHAR(HIRE_DATE,'RRRR');

TO_C MAX(SALARY)                                                                                                                                                                                        
---- -----------                                                                                                                                                                                        
1987        4400                                                                                                                                                                                        
1997        6000                                                                                                                                                                                        
1991        6000                                                                                                                                                                                        
1999        5800                                                                                                                                                                                        

SQL> REM MONTH , Q , YEAR
SQL> 
SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME LAST_NAME  EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                               
----------- ---------- ---------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                               
        100 Steven     King       SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                               
        101 Neena      Kochhar    NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                               
        102 Lex        De Haan    LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                               
        103 Alexander  Hunold     AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                               
        104 Bruce      Ernst      BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                               
        107 Diana      Lorentz    DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                               
        124 Kevin      Mourgos    KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                               
        141 Trenna     Rajs       TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                               
        142 Curtis     Davies     CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                               
        143 Randall    Matos      RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                               
        144 Peter      Vargas     PVARGAS    650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                               
        149 Eleni      Zlotkey    EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                               
        174 Ellen      Abel       EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                               
        176 Jonathon   Taylor     JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                               
        178 Kimerely   Grant      KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                             
        200 Jennifer   Whalen     JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                               
        201 Michael    Hartstein  MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                               
        202 Pat        Fay        PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                               
        205 Shelley    Higgins    SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                               
        206 William    Gietz      WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                               

20 rows selected.

SQL> REM DISPLAY JOB_ID WISE , TOTAL SALARY. EXCLUDE AD_PRES , AC_MGR , AC_ACCOUNT. 1 USING 'WHERE' 2 USING 'HAVING' 3 USING BOTH
SQL> 
SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  WHERE JOB_ID NOT IN ('AD_PRES','AC_MGR','AC_ACCOUNT');
SELECT JOB_ID , SUM(SALARY)
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  WHERE JOB_ID NOT IN ('AD_PRES','AC_MGR','AC_ACCOUNT')
  4  GROUP BY JOB_ID;

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            34000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

9 rows selected.

SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  HAVING JOB_ID <> ALL ('AD_PRES','AC_MGR','AC_ACCOUNT')
  4  GROUP BY JOB_ID;

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            34000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

9 rows selected.

SQL> SELECT JOB_ID , SUM(SALARY)
  2  FROM EMPLOYEES
  3  WHERE JOB_ID NOT IN ('AD_PRES','AC_MGR')
  4  GROUP BY JOB_ID
  5  HAVING JOB_ID NOT LIKE 'AC_ACCOUNT';

JOB_ID     SUM(SALARY)                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                  
IT_PROG          19200                                                                                                                                                                                  
ST_MAN            5800                                                                                                                                                                                  
AD_ASST           4400                                                                                                                                                                                  
AD_VP            34000                                                                                                                                                                                  
SA_MAN           10500                                                                                                                                                                                  
MK_MAN           13000                                                                                                                                                                                  
SA_REP           26600                                                                                                                                                                                  
MK_REP            6000                                                                                                                                                                                  
ST_CLERK         11700                                                                                                                                                                                  

9 rows selected.

SQL> REM NESTED SUMMARY FUNCTIONS :
SQL> 
SQL> REM NESTED SUMMARY FUNCTIONS : SUMMARY FUNCTION WITHIN ANOTHER/SAME SUMMARY FUNCTION
SQL> 
SQL> REM 1 WE CAN NEST SUMMARY FUNCTION ONLY UPTO TWO LEVELS.
SQL> 
SQL> REM 2 WHEN WE LIST NESTED SUMMARY ITEM IN SELECT, ALL OTHER ITEMS OF SELECT MUST BE NESTED SUMMARY ITEMS ONLY, EXCEPTION COUNT(*) , COUNT(GROUP BY COLUMN)
SQL> 
SQL> REM 3 WHEN WE USE NESTED SUMMARY ITEM 'GROUP BY' CLAUSE IS COMPULSORY.
SQL> 
SQL> 
SQL> 
SQL> 
SQL> SELECT AVG(SALARY) FROM EMPLOYEES;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       8775                                                                                                                                                                                             

SQL> SELECT SUM(AVG(SALARY)) FROM EMPLOYEES;
SELECT SUM(AVG(SALARY)) FROM EMPLOYEES
           *
ERROR at line 1:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT AVG(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

AVG(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
       7000                                                                                                                                                                                             
 19333.3333                                                                                                                                                                                             
       9500                                                                                                                                                                                             
      10150                                                                                                                                                                                             
       3500                                                                                                                                                                                             
 10033.3333                                                                                                                                                                                             
       6400                                                                                                                                                                                             
       4400                                                                                                                                                                                             

8 rows selected.

SQL> SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MAX(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      19333.3333                                                                                                                                                                                        

SQL> SELECT MIN(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MIN(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
            3500                                                                                                                                                                                        

SQL> SELECT MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MIN(AVG(SALARY)) MAX(AVG(SALARY))                                                                                                                                                                       
---------------- ----------------                                                                                                                                                                       
            3500       19333.3333                                                                                                                                                                       

SQL> SELECT AVG(SALARY) , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT AVG(SALARY) , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
           *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT DEPARTMENT_ID , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT DEPARTMENT_ID , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SQL> SELECT COUNT(DEPARTMENT_ID) , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

COUNT(DEPARTMENT_ID) MIN(AVG(SALARY)) MAX(AVG(SALARY))                                                                                                                                                  
-------------------- ---------------- ----------------                                                                                                                                                  
                   7             3500       19333.3333                                                                                                                                                  

SQL> SELECT COUNT(*) , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

  COUNT(*) MIN(AVG(SALARY)) MAX(AVG(SALARY))                                                                                                                                                            
---------- ---------------- ----------------                                                                                                                                                            
         8             3500       19333.3333                                                                                                                                                            

SQL> SELECT COUNT(JOB_ID) , MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

COUNT(JOB_ID) MIN(AVG(SALARY)) MAX(AVG(SALARY))                                                                                                                                                         
------------- ---------------- ----------------                                                                                                                                                         
            8             3500       19333.3333                                                                                                                                                         

SQL> SELECT MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

MAX(AVG(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
      19333.3333                                                                                                                                                                                        

SQL> SELECT COUNT(MAX(AVG(SALARY))) FROM EMPLOYEES GROUP BY DEPARTMENT_ID;
SELECT COUNT(MAX(AVG(SALARY))) FROM EMPLOYEES GROUP BY DEPARTMENT_ID
                 *
ERROR at line 1:
ORA-00935: group function is nested too deeply 


SQL> REM DISPLAY JOB_ID WISE HIGHEST TOTAL SALARY
SQL> 
SQL> SELECT MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID;

MAX(SUM(SALARY))                                                                                                                                                                                        
----------------                                                                                                                                                                                        
           34000                                                                                                                                                                                        

SQL> REM DISPLAY MANAGER_ID WISE LOWEST COUNT OF EMPLOYEES;
SQL> 
SQL> SELECT MIN(COUNT(*)) FROM EMPLOYEES GROUP BY MANAGER_ID;

MIN(COUNT(*))                                                                                                                                                                                           
-------------                                                                                                                                                                                           
            1                                                                                                                                                                                           

SQL> REM DISPLAY DEPARTMENT_ID WISE LOWEST AVERAGE SALARY , HIGHEST AVERAGE SALARY
SQL> 
SQL> SELECT MIN(AVG(SALARY)) , MAX(AVG(SALARY)) FROM EMPLOYEES GROUP BY DEPARTMENT_ID ;

MIN(AVG(SALARY)) MAX(AVG(SALARY))                                                                                                                                                                       
---------------- ----------------                                                                                                                                                                       
            3500       19333.3333                                                                                                                                                                       

SQL> REM JOB_ID WISE , MANAGER_ID WISE , LOWEST TOTAL SALARY , HIGHEST TOTAL SALARY
SQL> 
SQL> SELECT MIN(SUM(SALARY)) , MAX(SUM(SALARY)) FROM EMPLOYEES GROUP BY JOB_ID , MANAGER_ID;

MIN(SUM(SALARY)) MAX(SUM(SALARY))                                                                                                                                                                       
---------------- ----------------                                                                                                                                                                       
            4400            34000                                                                                                                                                                       

SQL> REM PCM : PIVOTE REPORT/CROSS TAB REPORT/MATRIX REPORT
SQL> 
SQL> REM MAXIMUM
SQL> 
SQL> SELECT MAX(SALARY) FROM EMPLOYEES;

MAX(SALARY)                                                                                                                                                                                             
-----------                                                                                                                                                                                             
      24000                                                                                                                                                                                             

SQL> REM DEPARTMENT_ID WISE
SQL> 
SQL> SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID ORDER BY 1;

DEPARTMENT_ID MAX(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           10        4400                                                                                                                                                                               
           20       13000                                                                                                                                                                               
           50        5800                                                                                                                                                                               
           60        9000                                                                                                                                                                               
           80       11000                                                                                                                                                                               
           90       24000                                                                                                                                                                               
          110       12000                                                                                                                                                                               
                     7000                                                                                                                                                                               

8 rows selected.

SQL> SELECT DEPARTMENT_ID , MAX(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID IN (10,110,50,90) GROUP BY DEPARTMENT_ID ORDER BY 1;

DEPARTMENT_ID MAX(SALARY)                                                                                                                                                                               
------------- -----------                                                                                                                                                                               
           10        4400                                                                                                                                                                               
           50        5800                                                                                                                                                                               
           90       24000                                                                                                                                                                               
          110       12000                                                                                                                                                                               

SQL> REM DEPT_10_MAX_SAL    DEPT_50_MAX_SAL    DEPT_90_MAX_SAL     DEPT_110_MAX_SAL
SQL> 
SQL> REM           4400               5800              24000                12000
SQL> 
SQL> 
SQL> 
SQL> SELECT MAX(DECODE(DEPARTMENT_ID,10,SALARY)) DEPT_10_MAX_SAL,
  2         MAX(DECODE(DEPARTMENT_ID,50,SALARY)) DEPT_50_MAX_SAL,
  3         MAX(DECODE(DEPARTMENT_ID,90,SALARY)) DEPT_90_MAX_SAL,
  4         MAX(DECODE(DEPARTMENT_ID,110,SALARY)) DEPT_110_MAX_SAL
  5  FROM EMPLOYEES;

DEPT_10_MAX_SAL DEPT_50_MAX_SAL DEPT_90_MAX_SAL DEPT_110_MAX_SAL                                                                                                                                        
--------------- --------------- --------------- ----------------                                                                                                                                        
           4400            5800           24000            12000                                                                                                                                        

SQL> REM IT_PROG_MIN_SAL    SA_REP_MIN_SAL     ST_CLERK_MIN_SAL
SQL> 
SQL> REM DECODE
SQL> 
SQL> SELECT MIN(DECODE(JOB_ID,'IT_PROG',SALARY)) IT_PROG_MIN_SAL,
  2         MIN(DECODE(JOB_ID,'SA_REP',SALARY)) SA_REP_MIN_SAL,
  3         MIN(DECODE(JOB_ID,'ST_CLERK',SALARY)) ST_CLERK_MIN_SAL
  4  FROM EMPLOYEES;

IT_PROG_MIN_SAL SA_REP_MIN_SAL ST_CLERK_MIN_SAL                                                                                                                                                         
--------------- -------------- ----------------                                                                                                                                                         
           4200           7000             2500                                                                                                                                                         

SQL> REM MGR_100_MIN_SAL     MGR_124_AVG_SAL     MGR_149_MAX_SAL
SQL> 
SQL> SELECT MIN(DECODE ( MANAGER_ID ,100,SALARY )) MGR_100_MIN_SAL,
  2  AVG(DECODE ( MANAGER_ID ,124,SALARY )) MGR_124_AVG_SAL,
  3  MAX(DECODE ( MANAGER_ID ,149,SALARY ))MGR_149_MAX_SAL FROM EMPLOYEES;

MGR_100_MIN_SAL MGR_124_AVG_SAL MGR_149_MAX_SAL                                                                                                                                                         
--------------- --------------- ---------------                                                                                                                                                         
           5800            2925           11000                                                                                                                                                         

SQL> SELECT MIN(CASE MANAGER_ID WHEN 100 THEN SALARY END) MGR_100_MIN_SAL,
  2         AVG(CASE MANAGER_ID WHEN 124 THEN SALARY END) MGR_124_AVG_SAL,
  3         MAX(CASE MANAGER_ID WHEN 149 THEN SALARY END) MGR_149_MAX_SAL FROM EMPLOYEES;

MGR_100_MIN_SAL MGR_124_AVG_SAL MGR_149_MAX_SAL                                                                                                                                                         
--------------- --------------- ---------------                                                                                                                                                         
           5800            2925           11000                                                                                                                                                         

SQL> REM IT_PROG_MIN_SAL    SA_REP_MIN_SAL     ST_CLERK_MIN_SAL
SQL> 
SQL> SELECT MIN(CASE JOB_ID WHEN 'IT_PROG' THEN SALARY END) IT_PROG_MIN_SAL,
  2             MIN(CASE JOB_ID WHEN 'SA_REP' THEN SALARY END) SA_REP_MIN_SAL,
  3             MIN(CASE JOB_ID WHEN 'ST_CLERK' THEN SALARY END) ST_CLERK_MIN_SAL FROM EMPLOYEES;

IT_PROG_MIN_SAL SA_REP_MIN_SAL ST_CLERK_MIN_SAL                                                                                                                                                         
--------------- -------------- ----------------                                                                                                                                                         
           4200           7000             2500                                                                                                                                                         

SQL> SELECT MIN(CASE WHEN JOB_ID = 'IT_PROG' THEN SALARY END) IT_PROG_MIN_SAL,
  2         MIN(CASE WHEN JOB_ID = 'SA_REP' THEN SALARY END) SA_REP_MIN_SAL,
  3         MIN(CASE WHEN JOB_ID = 'ST_CLERK' THEN SALARY END) ST_CLERK_MIN_SAL FROM EMPLOYEES;

IT_PROG_MIN_SAL SA_REP_MIN_SAL ST_CLERK_MIN_SAL                                                                                                                                                         
--------------- -------------- ----------------                                                                                                                                                         
           4200           7000             2500                                                                                                                                                         

SQL> REM DEPT_20_MIN_SAL     DEPT_50_AVG_SAL      DEPT_80_MAX_SAL
SQL> 
SQL> REM DECODE              CASE I               CASE II
SQL> 
SQL> 
SQL> SELECT MIN(DECODE(DEPARTMENT_ID,20,SALARY)) DEPT_20_MIN_SAL,
  2         AVG(CASE DEPARTMENT_ID WHEN 50 THEN SALARY END) DEPT_50_AVG_SAL,
  3         MAX(CASE WHEN DEPARTMENT_ID = 80 THEN SALARY END) DEPT_80_MAX_SAL
  4  FROM EMPLOYEES;

DEPT_20_MIN_SAL DEPT_50_AVG_SAL DEPT_80_MAX_SAL                                                                                                                                                         
--------------- --------------- ---------------                                                                                                                                                         
           6000            3500           11000                                                                                                                                                         

SQL> SELECT * FROM EMPLOYEES ORDER BY SALARY;

EMPLOYEE_ID FIRST_NAME LAST_NAME  EMAIL      PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                               
----------- ---------- ---------- ---------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                               
        144 Peter      Vargas     PVARGAS    650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                               
        143 Randall    Matos      RMATOS     650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                               
        142 Curtis     Davies     CDAVIES    650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                               
        141 Trenna     Rajs       TRAJS      650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                               
        107 Diana      Lorentz    DLORENTZ   590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                               
        200 Jennifer   Whalen     JWHALEN    515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                               
        124 Kevin      Mourgos    KMOURGOS   650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                               
        104 Bruce      Ernst      BERNST     590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                               
        202 Pat        Fay        PFAY       603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                               
        178 Kimerely   Grant      KGRANT     011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                             
        206 William    Gietz      WGIETZ     515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                               
        176 Jonathon   Taylor     JTAYLOR    011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                               
        103 Alexander  Hunold     AHUNOLD    590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                               
        149 Eleni      Zlotkey    EZLOTKEY   011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                               
        174 Ellen      Abel       EABEL      011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                               
        205 Shelley    Higgins    SHIGGINS   515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                               
        201 Michael    Hartstein  MHARTSTE   515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                               
        101 Neena      Kochhar    NKOCHHAR   515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                               
        102 Lex        De Haan    LDEHAAN    515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                               
        100 Steven     King       SKING      515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                               

20 rows selected.

SQL> REM DEPT_50_MIN_SAL   IT_PROG_AVG_SAL    MGR_100_MAX_SAL
SQL> 
SQL> REM DECODE            CASE I             CASE II
SQL> 
SQL> SELECT MIN(DECODE(DEPARTMENT_ID , 50 , SALARY)) DEPT_50_MIN_SAL,
  2         AVG(CASE JOB_ID WHEN 'IT_PROG' THEN SALARY END) IT_PROG_AVG_SAL,
  3         MAX(CASE MANAGER_ID = 100 THEN SALARY END) MGR_100_MAX_SAL
  4         FROM EMPLOYEES;
       MAX(CASE MANAGER_ID = 100 THEN SALARY END) MGR_100_MAX_SAL
                *
ERROR at line 3:
ORA-00907: missing right parenthesis 


SQL> SELECT MIN(DECODE(DEPARTMENT_ID , 50 , SALARY)) DEPT_50_MIN_SAL,
  2         AVG(CASE JOB_ID WHEN 'IT_PROG' THEN SALARY END) IT_PROG_AVG_SAL,
  3         MAX(CASE WHEN MANAGER_ID = 100 THEN SALARY END) MGR_100_MAX_SAL
  4         FROM EMPLOYEES;

DEPT_50_MIN_SAL IT_PROG_AVG_SAL MGR_100_MAX_SAL                                                                                                                                                         
--------------- --------------- ---------------                                                                                                                                                         
           2500            6400           17000                                                                                                                                                         

SQL> REM DEPT_90_CNT , DEPT_50_CNT , DEPT_110_CNT
SQL> 
SQL> SELECT COUNT(DECODE(DEPARTMENT_ID,90,'*')) DEPT_90_CNT,
  2         COUNT(DECODE(DEPARTMENT_ID,50,7)) DEPT_50_CNT,
  3         COUNT(DECODE(DEPARTMENT_ID,110,SYSDATE)) DEPT_50_CNT
  4  FROM EMPLOYEES;

DEPT_90_CNT DEPT_50_CNT DEPT_50_CNT                                                                                                                                                                     
----------- ----------- -----------                                                                                                                                                                     
          3           5           2                                                                                                                                                                     

SQL> SELECT COUNT(DECODE(DEPARTMENT_ID,90,'*')) DEPT_90_CNT,
  2         COUNT(DECODE(DEPARTMENT_ID,50,7)) DEPT_50_CNT,
  3         COUNT(DECODE(DEPARTMENT_ID,110,SYSDATE)) DEPT_110_CNT
  4  FROM EMPLOYEES;

DEPT_90_CNT DEPT_50_CNT DEPT_110_CNT                                                                                                                                                                    
----------- ----------- ------------                                                                                                                                                                    
          3           5            2                                                                                                                                                                    

SQL> 
SQL> 
SQL> 
SQL> SELECT MANAGER_ID , COUNT(DECODE(DEPARTMENT_ID,90,'*')) DEPT_90_CNT,
  2         COUNT(DECODE(DEPARTMENT_ID,50,7)) DEPT_50_CNT,
  3         COUNT(DECODE(DEPARTMENT_ID,110,SYSDATE)) DEPT_110_CNT
  4  FROM EMPLOYEES
  5  GROUP BY MANAGER_ID
  6  ORDER BY 1;

MANAGER_ID DEPT_90_CNT DEPT_50_CNT DEPT_110_CNT                                                                                                                                                         
---------- ----------- ----------- ------------                                                                                                                                                         
       100           2           1            0                                                                                                                                                         
       101           0           0            1                                                                                                                                                         
       102           0           0            0                                                                                                                                                         
       103           0           0            0                                                                                                                                                         
       124           0           4            0                                                                                                                                                         
       149           0           0            0                                                                                                                                                         
       201           0           0            0                                                                                                                                                         
       205           0           0            1                                                                                                                                                         
                     1           0            0                                                                                                                                                         

9 rows selected.

SQL> REM DISPLAY COUNTS OF DEPATMENT 90 , 50 AND 110 FOR EACH MANAGER
SQL> 
SQL> 
SQL> 
SQL> REM DISPLAY SUM OF SALARY FOR MANAGER 100, 124 AND 149 , JOB_ID WISE
SQL> 
SQL> REM                                 DECODE CASE I  CASE II
SQL> 
SQL> SELECT JOB_ID SUM(DECODE(MANAGER_ID,100,SALARY)) MGR_100_TOTAL_SAL,SUM(CASE MANAGER_ID WHEN 124 THEN SALARY END) MGR_124_TOTAL_SAL,SUM(CASE WHEN MANAGER_ID=149 THEN SALARY END) MGR_149_TOTAL_SAL FROM EMPLOYEES GROUP BY JOB_ID;
SELECT JOB_ID SUM(DECODE(MANAGER_ID,100,SALARY)) MGR_100_TOTAL_SAL,SUM(CASE MANAGER_ID WHEN 124 THEN SALARY END) MGR_124_TOTAL_SAL,SUM(CASE WHEN MANAGER_ID=149 THEN SALARY END) MGR_149_TOTAL_SAL FROM EMPLOYEES GROUP BY JOB_ID
                 *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT SUM(DECODE(MANAGER_ID , 100 , SALARY)) MGR_100_SUM_SAL,
  2         SUM(CASE MANAGER_ID WHEN 124 THEN SALARY END) MGR_124_SUM_SAL,
  3         SUM(CASE WHEN MANAGER_ID=149 THEN SALARY END) MGR_149_SUM_SAL
  4         FROM EMPLOYEES GROUP BY JOB_ID;

MGR_100_SUM_SAL MGR_124_SUM_SAL MGR_149_SUM_SAL                                                                                                                                                         
--------------- --------------- ---------------                                                                                                                                                         
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
           5800                                                                                                                                                                                         
                                                                                                                                                                                                        
          34000                                                                                                                                                                                         
          10500                                                                                                                                                                                         
          13000                                                                                                                                                                                         
                                                                                                                                                                                                        
                                          26600                                                                                                                                                         
                                                                                                                                                                                                        
                          11700                                                                                                                                                                         

12 rows selected.

SQL> SELECT JOB_ID,
  2         SUM(DECODE(MANAGER_ID,100,SALARY))MGR_100_SUM,
  3         SUM(CASE WHEN MANAGER_ID = 100 THEN SALARY END)MGR_124_SUM,
  4         SUM(CASE MANAGER_ID WHEN 100 THEN SALARY END)MGR_149_SUM FROM EMPLOYEES GROUP BY JOB_ID;

JOB_ID     MGR_100_SUM MGR_124_SUM MGR_149_SUM                                                                                                                                                          
---------- ----------- ----------- -----------                                                                                                                                                          
IT_PROG                                                                                                                                                                                                 
AC_MGR                                                                                                                                                                                                  
AC_ACCOUNT                                                                                                                                                                                              
ST_MAN            5800        5800        5800                                                                                                                                                          
AD_ASST                                                                                                                                                                                                 
AD_VP            34000       34000       34000                                                                                                                                                          
SA_MAN           10500       10500       10500                                                                                                                                                          
MK_MAN           13000       13000       13000                                                                                                                                                          
AD_PRES                                                                                                                                                                                                 
SA_REP                                                                                                                                                                                                  
MK_REP                                                                                                                                                                                                  
ST_CLERK                                                                                                                                                                                                

12 rows selected.

SQL> SELECT JOB_ID , SUM(DECODE( MANAGER_ID ,100 ,SALARY))MGR_100__SAL,
  2  SUM(CASE MANAGER_ID WHEN 124 THEN SALARY  END)MGR_124_SAL,
  3  SUM(CASE WHEN MANAGER_ID = 110 THEN SALARY END) MGR_110_SAL FROM EMPLOYEES GROUP BY JOB_ID ORDER BY 1;

JOB_ID     MGR_100__SAL MGR_124_SAL MGR_110_SAL                                                                                                                                                         
---------- ------------ ----------- -----------                                                                                                                                                         
AC_ACCOUNT                                                                                                                                                                                              
AC_MGR                                                                                                                                                                                                  
AD_ASST                                                                                                                                                                                                 
AD_PRES                                                                                                                                                                                                 
AD_VP             34000                                                                                                                                                                                 
IT_PROG                                                                                                                                                                                                 
MK_MAN            13000                                                                                                                                                                                 
MK_REP                                                                                                                                                                                                  
SA_MAN            10500                                                                                                                                                                                 
SA_REP                                                                                                                                                                                                  
ST_CLERK                      11700                                                                                                                                                                     
ST_MAN             5800                                                                                                                                                                                 

12 rows selected.

SQL> SELECT JOB_ID,SUM(DECODE(MANAGER_ID,100,SALARY)) MGR_100_TOTAL_SAL,SUM(CASE MANAGER_ID WHEN 124 THEN SALARY END) MGR_124_TOTAL_SAL,SUM(CASE WHEN MANAGER_ID=149 THEN SALARY END) MGR_149_TOTAL_SAL FROM EMPLOYEES GROUP BY JOB_ID;

JOB_ID     MGR_100_TOTAL_SAL MGR_124_TOTAL_SAL MGR_149_TOTAL_SAL                                                                                                                                        
---------- ----------------- ----------------- -----------------                                                                                                                                        
IT_PROG                                                                                                                                                                                                 
AC_MGR                                                                                                                                                                                                  
AC_ACCOUNT                                                                                                                                                                                              
ST_MAN                  5800                                                                                                                                                                            
AD_ASST                                                                                                                                                                                                 
AD_VP                  34000                                                                                                                                                                            
SA_MAN                 10500                                                                                                                                                                            
MK_MAN                 13000                                                                                                                                                                            
AD_PRES                                                                                                                                                                                                 
SA_REP                                                     26600                                                                                                                                        
MK_REP                                                                                                                                                                                                  
ST_CLERK                                 11700                                                                                                                                                          

12 rows selected.

SQL> REM HIRE YEAR WISE : CNT_DEPT_90  MIN_MGR_100   AVG_IT_PROG  SUM_SAL_ALL
SQL> 
SQL> REM                  DECODE       CASE I        CASE II
SQL> 
SQL> SELECT TO_CHAR(HIRE_DATE,'RRRR'),COUNT(DECODE(DEPARTMENT_ID,90,'*')) CNT_DEPT_90,
  2  MIN(CASE MANAGER_ID WHEN 100 THEN SALARY END) MIN_MGR_100,
  3  AVG(CASE WHEN JOB_ID = 'IT_PROG' THEN SALARY END) AVG_IT_PROG,
  4  SUM(SALARY) SUM_SAL_ALL FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'RRRR');

TO_C CNT_DEPT_90 MIN_MGR_100 AVG_IT_PROG SUM_SAL_ALL                                                                                                                                                    
---- ----------- ----------- ----------- -----------                                                                                                                                                    
1987           1                               28400                                                                                                                                                    
1997           0                                9100                                                                                                                                                    
2000           0       10500                   10500                                                                                                                                                    
1994           0                               20300                                                                                                                                                    
1991           0                    6000        6000                                                                                                                                                    
1995           0                                3500                                                                                                                                                    
1990           0                    9000        9000                                                                                                                                                    
1989           1       17000                   17000                                                                                                                                                    
1993           1       17000                   17000                                                                                                                                                    
1999           0        5800        4200       17000                                                                                                                                                    
1996           0       13000                   24000                                                                                                                                                    
1998           0                               13700                                                                                                                                                    

12 rows selected.

SQL> SPOOL OFF
